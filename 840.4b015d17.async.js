"use strict";(self.webpackChunk_quansitech_pallas_h5=self.webpackChunk_quansitech_pallas_h5||[]).push([[840],{9840:function(D,h,t){t.r(h);var c=t(17061),p=t.n(c),v=t(17156),m=t.n(v),g=t(86327);h.default={upload:function(){var d=m()(p()().mark(function n(a,_,s){var f,e,l,i,o,E,y,b,T;return p()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(f=new FormData,e=new URLSearchParams(_),s&&e.append("hash_id",s),l=a.type,l){r.next=8;break}return r.next=7,g.Z.getFileType.start(a);case 7:l=r.sent;case 8:return e.append("vendor_type","volcengine_tos"),e.append("file_type",l),e.append("title",a.name),r.next=13,fetch(decodeURIComponent(e.toString()));case 13:return i=r.sent,r.next=16,i.json();case 16:if(o=r.sent,parseInt(o.status)!==2){r.next=19;break}return r.abrupt("return",{file_id:o.file_id,url:o.file_url});case 19:E=o.params;for(y in E)f.append(y,E[y]);return f.append("file",a),r.next=24,fetch(o.url,{method:"POST",body:f});case 24:return b=r.sent,r.next=27,b.json();case 27:return T=r.sent,r.abrupt("return",T);case 29:case"end":return r.stop()}},n)}));function u(n,a,_){return d.apply(this,arguments)}return u}()}},86327:function(D,h,t){var c=t(17061),p=t.n(c),v=t(17156),m=t.n(v),g={getFileType:{fileToArrayBuffer:function(){var d=m()(p()().mark(function n(a,_){var s;return p()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=new FileReader,s.onload=function(l){if(typeof _=="function")return _(l.target.result)},s.readAsArrayBuffer(a);case 3:case"end":return e.stop()}},n)}));function u(n,a){return d.apply(this,arguments)}return u}(),getFileTypeViaHeader:function(u){for(var n=new Uint8Array(u),a=n.slice(0,4),_=n.slice(0,16),s="",f="",e,l=0;l<a.length;l++)s+=a[l].toString(16);for(var i=0;i<_.length;i++)f+=_[i].toString(16);switch(s){case"89504e47":e="image/png";break;case"47494638":e="image/gif";break;case"ffd8ffDB":case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":case"ffd8ffe3":case"ffd8ffe8":e="image/jpeg";break;case"00020":case"00018":case"00024":case"0001c":f.lastIndexOf("000")===22?e="image/heic":e="unknown";break;default:e="unknown";break}return e},start:function(){var d=m()(p()().mark(function n(a){var _,s;return p()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _=this,s=new Promise(function(l){_.fileToArrayBuffer(a,function(i){var o=_.getFileTypeViaHeader(i);l(o)})}),e.abrupt("return",s);case 3:case"end":return e.stop()}},n,this)}));function u(n){return d.apply(this,arguments)}return u}()},getSuffix:function(u){var n=u.lastIndexOf("."),a="";return n!==-1&&(a=u.substring(n)),a}};h.Z=g}}]);
